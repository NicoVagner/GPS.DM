(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10154,        229]
NotebookOptionsPosition[      9252,        207]
NotebookOutlinePosition[      9692,        224]
CellTagsIndexPosition[      9649,        221]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Z", " ", "=", "6.1486"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r", "=", "0.635"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M", "=", "5000"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"integrand", "[", 
     RowBox[{"u_", ",", "Z_", ",", "r_", ",", "M_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"u", "^", "2"}]}], "/", "2"}], "]"}], "/", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"2", "*", "Pi"}], "]"}]}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Erf", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Z", "+", 
               RowBox[{
                RowBox[{"Sqrt", "[", "r", "]"}], "*", "u"}]}], ")"}], "/", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"1", "-", "r"}], ")"}]}], "]"}]}], "]"}], "-", 
           RowBox[{"Erf", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "Z"}], "+", 
               RowBox[{
                RowBox[{"Sqrt", "[", "r", "]"}], "*", "u"}]}], ")"}], "/", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"1", "-", "r"}], ")"}]}], "]"}]}], "]"}]}], ")"}], 
         "/", "2"}], ")"}], "^", "M"}]}], ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"result1", "=", 
     RowBox[{"SetPrecision", "[", 
      RowBox[{
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{"integrand", "[", 
          RowBox[{"u", ",", "Z", ",", "r", ",", "M"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"u", ",", 
           RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",", 
         RowBox[{"Method", "->", "\"\<GaussBerntsenEspelidRule\>\""}]}], 
        "]"}], ",", "20"}], "]"}]}], ";"}], "\n", 
   RowBox[{"result2", "=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{"integrand", "[", 
       RowBox[{"u", ",", "Z", ",", "r", ",", "M"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"u", ",", 
        RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}], ",", 
      RowBox[{"Method", "->", "\"\<GaussBerntsenEspelidRule\>\""}], ",", 
      RowBox[{"AccuracyGoal", "->", "10"}], ",", 
      RowBox[{"PrecisionGoal", "->", "10"}], ",", 
      RowBox[{"WorkingPrecision", "->", "1000"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"1", "-", "result"}], ",", "20"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.932473273034893*^9, 3.932473334427583*^9}, 
   3.932473391337612*^9, {3.932473450288873*^9, 3.932473463320919*^9}, {
   3.932473504789654*^9, 3.932473552434099*^9}, {3.932487204814581*^9, 
   3.932487356622134*^9}, {3.932487404268814*^9, 3.932487460821001*^9}, {
   3.932487501534434*^9, 3.9324875571856155`*^9}, {3.932644197862541*^9, 
   3.932644198600281*^9}, {3.932644267147722*^9, 3.9326443629703217`*^9}, {
   3.9326444030961847`*^9, 3.9326444947021437`*^9}, {3.932644525923111*^9, 
   3.932644560000189*^9}, {3.932644690092779*^9, 3.9326446902321596`*^9}, {
   3.932644993760933*^9, 3.932645005810636*^9}, {3.932645087273378*^9, 
   3.932645105823353*^9}, {3.932645251472998*^9, 3.932645321432705*^9}, {
   3.933188943996645*^9, 
   3.933188944632822*^9}},ExpressionUUID->"e03b6b62-8648-3143-82ff-\
1ef5a4ac8966"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "precw", 
   "\"The precision of the argument function \
(\\!\\(\\*FractionBox[RowBox[{SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{\\\"-\\\", FractionBox[SuperscriptBox[\\\"u\\\", \\\"2\\\"], \
\\\"2\\\"]}]], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", RowBox[{\\\"Erf\\\", \\\"[\\\", \
RowBox[{\\\"1.1704114719613057`\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"6.1486`\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}], \\\"]\\\"}]}], \
\\\"+\\\", RowBox[{\\\"Erf\\\", \\\"[\\\", \
RowBox[{\\\"1.1704114719613057`\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"6.1486`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"0.7968688725254613`\\\", \\\" \\\", \\\"u\\\"}]}], \\\")\\\"}]}], \
\\\"]\\\"}]}], \\\")\\\"}], \\\"1000\\\"]}], \
RowBox[{RowBox[{\\\"\
107150860718626732094842504906000181056140481170553360744375038837035105112493\
6122493198378815695858127594672917553146825187145285\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"42\\\", \\\"\[RightSkeleton]\\\"}], \
\\\"09854210746050623711418779541821530464749835819412673987675591655439460770\
62914571196477686542167660429831652624386837205668069376\\\"}], \\\" \\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]}]]\\)) \
is less than WorkingPrecision (\\!\\(\\*RowBox[{\\\"1000.`\\\"}]\\)).\"", 2, 
   293, 9, 23149127403733693551, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.932645266537405*^9, 3.932645350436882*^9}},
 CellLabel->
  "During evaluation of \
In[288]:=",ExpressionUUID->"db769e1a-f54d-d34d-a2c5-fe870e05e58b"],

Cell[BoxData["0.\
999999418857352578161470592802872265855501343941436841199603808243623997209904\
789459786876549573786824092450428811123932085340074354789648951021478342081214\
236194841016441517218598376841003009895412723542982357181737268170030747890001\
313735013316751127244979371040157598673408041864456696665164565111612561509573\
808342910768722795823171776400437681671405390457236327177320301941578339633973\
495983194066831772187804505967921120938136882968122557326630994426608686660201\
362285335321347080917423173973662534980394874845777110139911110169164787887475\
151556153495345746015183201005165031784026262862779493909899287644371621658845\
020595234136804891934313151670675598806191013537994231923483998079674960208536\
040122673782121012048298953399596319577349110046685048605390866055070345929991\
189269811929901774308988359894360769338317634024726271551517337488257266851496\
862233762438102887685813849993093859409539824717666849152075425876500142660910\
696892473759795267252792003666907430043944666832061989060575081244459510593813\
637718`1000."], "Output",
 CellChangeTimes->{
  3.932473338061874*^9, 3.932473393189432*^9, {3.932473453218579*^9, 
   3.932473466602417*^9}, {3.93247350592663*^9, 3.932473552857229*^9}, 
   3.9324871443318*^9, {3.932487206058065*^9, 3.932487228796221*^9}, {
   3.932487262556492*^9, 3.9324873569845257`*^9}, {3.932487424390573*^9, 
   3.932487557563938*^9}, {3.9326443137543945`*^9, 3.9326443320236454`*^9}, 
   3.932644365461197*^9, {3.9326444036948376`*^9, 3.932644495082453*^9}, {
   3.932644555143757*^9, 3.9326445603516273`*^9}, 3.932644694971468*^9, 
   3.932645010059843*^9, {3.932645266515501*^9, 3.932645289727892*^9}, {
   3.9326453219692993`*^9, 3.9326453787801895`*^9}},
 CellLabel->
  "Out[293]=",ExpressionUUID->"d1fa1e4d-2fb2-0040-819f-ef0bbd3e6f28"],

Cell[BoxData["5.8033619776409750556922517716884`20.*^-7"], "Output",
 CellChangeTimes->{
  3.932473338061874*^9, 3.932473393189432*^9, {3.932473453218579*^9, 
   3.932473466602417*^9}, {3.93247350592663*^9, 3.932473552857229*^9}, 
   3.9324871443318*^9, {3.932487206058065*^9, 3.932487228796221*^9}, {
   3.932487262556492*^9, 3.9324873569845257`*^9}, {3.932487424390573*^9, 
   3.932487557563938*^9}, {3.9326443137543945`*^9, 3.9326443320236454`*^9}, 
   3.932644365461197*^9, {3.9326444036948376`*^9, 3.932644495082453*^9}, {
   3.932644555143757*^9, 3.9326445603516273`*^9}, 3.932644694971468*^9, 
   3.932645010059843*^9, {3.932645266515501*^9, 3.932645289727892*^9}, {
   3.9326453219692993`*^9, 3.9326453787831764`*^9}},
 CellLabel->
  "Out[294]=",ExpressionUUID->"3c48c8ad-3c5b-5049-aace-d75c21ca07c8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"5.804441269852134", "e"}], "-", "07"}]], "Input",
 CellChangeTimes->{{3.9326444405441456`*^9, 3.932644441217367*^9}, 
   3.9326450468242474`*^9},ExpressionUUID->"69f61db1-0003-1047-9019-\
c89e576e38a1"],

Cell[BoxData[
 RowBox[{"q", "=", 
  RowBox[{"5.802891933", " ", "*", 
   RowBox[{"10", "^", 
    RowBox[{"-", "7"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9326456749121723`*^9, 
  3.9326456836902504`*^9}},ExpressionUUID->"115ab3c7-0c19-0846-bcb7-\
de2deaa43c73"]
},
WindowSize->{1152, 585.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3eacdabf-82d1-984e-ada1-972a2268f023"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 3736, 92, 276, "Input",ExpressionUUID->"e03b6b62-8648-3143-82ff-1ef5a4ac8966"],
Cell[4319, 116, 1773, 30, 137, "Message",ExpressionUUID->"db769e1a-f54d-d34d-a2c5-fe870e05e58b"],
Cell[6095, 148, 1824, 26, 147, "Output",ExpressionUUID->"d1fa1e4d-2fb2-0040-819f-ef0bbd3e6f28"],
Cell[7922, 176, 809, 12, 32, "Output",ExpressionUUID->"3c48c8ad-3c5b-5049-aace-d75c21ca07c8"]
}, Open  ]],
Cell[8746, 191, 237, 5, 28, "Input",ExpressionUUID->"69f61db1-0003-1047-9019-c89e576e38a1"],
Cell[8986, 198, 262, 7, 28, "Input",ExpressionUUID->"115ab3c7-0c19-0846-bcb7-de2deaa43c73"]
}
]
*)

